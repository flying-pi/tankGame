<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="d2/db5/simpleconnection_8cpp">
    <title>simpleconnection.cpp File Reference</title>
    <programlisting>#include &quot;simpleconnection.h&quot;</programlisting>
    <programlisting>#include &quot;../coreconst.h&quot;</programlisting>
    <programlisting>#include &lt;QMetaEnum&gt;</programlisting>
<para>Include dependency diagram for simpleconnection.cpp</para>
<para>
    <figure>
        <title>Dependency diagram</title>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="1" fileref="../../d4/d72/simpleconnection_8cpp__incl.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </figure>
</para>
<para>Included by dependency diagram for simpleconnection.cpp</para>
<para>
    <figure>
        <title>Dependency diagram</title>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="1" fileref="../../df/dc8/simpleconnection_8cpp__dep__incl.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </figure>
</para>
        <section>
            <title>Functions</title>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>QString <link linkend="d2/db5/simpleconnection_8cpp_1aabd3ff178ce3faed55804cc56f78fc6a">stringify</link> (
<link linkend="d1/d70/simpleconnection_8h_1ab66d8802c50493de7d50e181d6f8e296">eConnectionType</link> e)</para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>QString <link linkend="d2/db5/simpleconnection_8cpp_1abb3e44449c2fd1fa9275c1d4273c66f9">stringify</link> (
<link linkend="d1/d70/simpleconnection_8h_1a700ed30d49bfe436323e17539d3a0010">eMessageType</link> e)</para>
                    </listitem>
                </itemizedlist>
            </para>
        </section>
    <simplesect>
        <title>Detailed Description</title>
    <para>Definition in file /Users/yurabraiko/dev/qt/TankGame/Core/connection/simpleconnection.cpp</para>
    </simplesect>
    <literallayout><computeroutput>
1 <emphasis class="preprocessor">#include&#32;&quot;<link linkend="d1/d70/simpleconnection_8h">simpleconnection.h</link>&quot;</emphasis>
2 <emphasis class="preprocessor">#include&#32;&quot;../coreconst.h&quot;</emphasis>
3 <emphasis class="preprocessor">#include&#32;&lt;QMetaEnum&gt;</emphasis>
4 
<link linkend="d5/de0/classSimpleConnection_1a2bcb23e4dcb42f9149d6c66b326fc475">5 </link><link linkend="d5/de0/classSimpleConnection_1a2bcb23e4dcb42f9149d6c66b326fc475">SimpleConnection::SimpleConnection</link>(QHostAddress&#32;adress,&#32;QObject*&#32;parent)
6 &#32;&#32;&#32;&#32;:&#32;QThread(parent)&#32;{
7 &#32;&#32;this-&gt;adress&#32;=&#32;<link linkend="d5/de0/classSimpleConnection_1afd0b4e345d57b690f1a1e12c4816e268">adress</link>;
8 }
9 
<link linkend="d5/de0/classSimpleConnection_1a61b33627900c86ffa7f7936acae2873a">10 </link><link linkend="d5/de0/classSimpleConnection_1a61b33627900c86ffa7f7936acae2873a">SimpleConnection::~SimpleConnection</link>()&#32;{
11 &#32;&#32;<emphasis class="keyword">delete</emphasis>&#32;<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>;
12 &#32;&#32;<emphasis class="keyword">delete</emphasis>&#32;<link linkend="d5/de0/classSimpleConnection_1a8db5848b9d5d30739d609feb973b86d2">out</link>;
13 }
14 
<link linkend="d5/de0/classSimpleConnection_1a47370c85490330b8e1dd64af9e70b683">15 </link><emphasis class="keywordtype">void</emphasis>&#32;<link linkend="d5/de0/classSimpleConnection_1a47370c85490330b8e1dd64af9e70b683">SimpleConnection::openConnection</link>()&#32;{
16 &#32;&#32;this-&gt;start();
17 }
18 
<link linkend="d5/de0/classSimpleConnection_1a2bbd5504e2e67fa95a701f77cd438f4d">19 </link><link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder">SimpleConnection::MessageBuilder</link>*&#32;<link linkend="d5/de0/classSimpleConnection_1a2bbd5504e2e67fa95a701f77cd438f4d">SimpleConnection::getBulder</link>()&#32;{
20 &#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder">MessageBuilder</link>(<emphasis class="keyword">this</emphasis>);
21 }
22 
<link linkend="d5/de0/classSimpleConnection_1a8360af71c89a54be93430b746d5fae08">23 </link><emphasis class="keywordtype">void</emphasis>&#32;<link linkend="d5/de0/classSimpleConnection_1a8360af71c89a54be93430b746d5fae08">SimpleConnection::onSocketError</link>(QAbstractSocket::SocketError&#32;err)&#32;{
24 &#32;&#32;qCritical()&#32;&lt;&lt;&#32;err;
25 &#32;&#32;<link linkend="d5/de0/classSimpleConnection_1a45a1e7ba5a9538bd382d24d364d0bbe5">isWork</link>&#32;=&#32;<emphasis class="keyword">false</emphasis>;
26 &#32;&#32;<emphasis class="comment">//&#32;TODO&#32;add&#32;something</emphasis>
27 }
28 
<link linkend="d5/de0/classSimpleConnection_1a35045483589d14a436ee83346365ce70">29 </link><emphasis class="keywordtype">void</emphasis>&#32;<link linkend="d5/de0/classSimpleConnection_1a35045483589d14a436ee83346365ce70">SimpleConnection::run</link>()&#32;{
30 &#32;&#32;<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;QTcpSocket();
31 &#32;&#32;connect(<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>,&#32;SIGNAL(error(QAbstractSocket::SocketError)),&#32;<emphasis class="keyword">this</emphasis>,
32 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;SLOT(<link linkend="d5/de0/classSimpleConnection_1a8360af71c89a54be93430b746d5fae08">onSocketError</link>(QAbstractSocket::SocketError)),
33 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Qt::DirectConnection);
34 &#32;&#32;<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>-&gt;connectToHost(<link linkend="d5/de0/classSimpleConnection_1afd0b4e345d57b690f1a1e12c4816e268">adress</link>,&#32;<link linkend="de/dc0/namespaceDefaultServerParams_1a7ac0709dc92e311b3524c365a2a05d96">DefaultServerParams::port</link>);
35 &#32;&#32;<link linkend="d5/de0/classSimpleConnection_1a45a1e7ba5a9538bd382d24d364d0bbe5">isWork</link>&#32;=&#32;<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>-&gt;waitForConnected();
36 &#32;&#32;qDebug()&#32;&lt;&lt;&#32;<emphasis class="stringliteral">&quot;Connect&#32;to&#32;server&#32;on&#32;&quot;</emphasis>&#32;&lt;&lt;&#32;<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>-&gt;peerAddress().toString()&#32;&lt;&lt;&#32;<emphasis class="stringliteral">&quot;:&quot;</emphasis>
37 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;&lt;&#32;<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>-&gt;peerPort();
38 &#32;&#32;<link linkend="d5/de0/classSimpleConnection_1a8db5848b9d5d30739d609feb973b86d2">out</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;QDataStream();
39 &#32;&#32;<link linkend="d5/de0/classSimpleConnection_1a8db5848b9d5d30739d609feb973b86d2">out</link>-&gt;setDevice(<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>);
40 &#32;&#32;<link linkend="d5/de0/classSimpleConnection_1a8db5848b9d5d30739d609feb973b86d2">out</link>-&gt;setVersion(QDataStream::Qt_5_7);
41 
42 &#32;&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver">Receiver</link>*&#32;receiver&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver">Receiver</link>(<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>,&#32;<emphasis class="keyword">this</emphasis>);
43 &#32;&#32;<emphasis class="keywordflow">while</emphasis>&#32;(!receiver-&gt;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a7cd5d65acac04d9eaa59817f15ddae62">istThreadStart</link>())
44 &#32;&#32;&#32;&#32;qInfo()&#32;&lt;&lt;&#32;<emphasis class="stringliteral">&quot;whaiting&#32;for&#32;receiver&#32;loop&#32;start........&quot;</emphasis>;
45 
46 &#32;&#32;qInfo()&#32;&lt;&lt;&#32;<emphasis class="stringliteral">&quot;starting&#32;sending&#32;to&#32;server&#32;message&#32;loop&quot;</emphasis>;
47 &#32;&#32;<emphasis class="keywordflow">while</emphasis>&#32;(<link linkend="d5/de0/classSimpleConnection_1a45a1e7ba5a9538bd382d24d364d0bbe5">isWork</link>)&#32;{
48 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(<link linkend="d5/de0/classSimpleConnection_1aadfc449afe00e48e200ae5f94bc9f2f7">messages</link>.length()&#32;&gt;&#32;0)&#32;{
49 &#32;&#32;&#32;&#32;&#32;&#32;<link linkend="db/dbc/classMessageForServer">MessageForServer</link>*&#32;newMessage&#32;=&#32;<link linkend="d5/de0/classSimpleConnection_1aadfc449afe00e48e200ae5f94bc9f2f7">messages</link>.takeFirst();
50 &#32;&#32;&#32;&#32;&#32;&#32;<link linkend="d5/de0/classSimpleConnection_1a8db5848b9d5d30739d609feb973b86d2">out</link>-&gt;startTransaction();
51 &#32;&#32;&#32;&#32;&#32;&#32;(*out)&#32;&lt;&lt;&#32;(*newMessage);
52 &#32;&#32;&#32;&#32;&#32;&#32;<link linkend="d5/de0/classSimpleConnection_1a8db5848b9d5d30739d609feb973b86d2">out</link>-&gt;commitTransaction();
53 &#32;&#32;&#32;&#32;&#32;&#32;<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>-&gt;flush();
54 &#32;&#32;&#32;&#32;&#32;&#32;qInfo()&#32;&lt;&lt;&#32;<emphasis class="stringliteral">&quot;sending&#32;some&#32;message&#32;for&#32;server&quot;</emphasis>;
55 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">continue</emphasis>;
56 &#32;&#32;&#32;&#32;}&#32;<emphasis class="keywordflow">else</emphasis>&#32;{
57 &#32;&#32;&#32;&#32;&#32;&#32;msleep(100);
58 &#32;&#32;&#32;&#32;}
59 &#32;&#32;}
60 &#32;&#32;receiver-&gt;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1ab77d06e9677b12631ece8695a319e062">stop</link>();
61 &#32;&#32;<emphasis class="keyword">delete</emphasis>&#32;receiver;
62 }
63 
<link linkend="d5/de0/classSimpleConnection_1a0e40869759ba98f1964257d9c507b733">64 </link><emphasis class="keywordtype">void</emphasis>&#32;<link linkend="d5/de0/classSimpleConnection_1a0e40869759ba98f1964257d9c507b733">SimpleConnection::addMessage</link>(<link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder">MessageBuilder</link>*&#32;message)&#32;{
65 &#32;&#32;<link linkend="d5/de0/classSimpleConnection_1acb6f6147828cec46cc69459f0de82cb0">mutex</link>.lock();
66 &#32;&#32;this-&gt;<link linkend="d5/de0/classSimpleConnection_1aadfc449afe00e48e200ae5f94bc9f2f7">messages</link>.push_back(message-&gt;<link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder_1a7a57d1afb561f7fe4b813e611c3269a7">message</link>);
67 &#32;&#32;<emphasis class="keyword">delete</emphasis>&#32;message;
68 &#32;&#32;<link linkend="d5/de0/classSimpleConnection_1acb6f6147828cec46cc69459f0de82cb0">mutex</link>.unlock();
69 }
70 
<link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder_1a872f905bf802df170dc7d1e0e9e75105">71 </link><link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder_1a872f905bf802df170dc7d1e0e9e75105">SimpleConnection::MessageBuilder::MessageBuilder</link>(<link linkend="d5/de0/classSimpleConnection">SimpleConnection</link>*&#32;sender)&#32;{
72 &#32;&#32;this-&gt;parent&#32;=&#32;sender;
73 &#32;&#32;this-&gt;message&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="db/dbc/classMessageForServer">MessageForServer</link>();
74 }
75 
76 <link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder">SimpleConnection::MessageBuilder</link>*
<link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder_1ae54a2b522f87b6cbab31d9ee27f29264">77 </link><link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder_1ae54a2b522f87b6cbab31d9ee27f29264">SimpleConnection::MessageBuilder::asFirstMessage</link>(<link linkend="d1/d70/simpleconnection_8h_1ab66d8802c50493de7d50e181d6f8e296">eConnectionType</link>&#32;type)&#32;{
78 &#32;&#32;this-&gt;message-&gt;connectionType&#32;=&#32;type;
79 &#32;&#32;this-&gt;message-&gt;messageType&#32;=&#32;<link linkend="d1/d70/simpleconnection_8h_1a700ed30d49bfe436323e17539d3a0010aeab6dec369184e6c7d133812064686f9">eFirstMessae</link>;
80 &#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;<emphasis class="keyword">this</emphasis>;
81 }
82 
<link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder_1ac39d9787cbea1c6d81a7cdbc736c9061">83 </link><emphasis class="keywordtype">void</emphasis>&#32;<link linkend="d3/d04/classSimpleConnection_1_1MessageBuilder_1ac39d9787cbea1c6d81a7cdbc736c9061">SimpleConnection::MessageBuilder::build</link>()&#32;{
84 &#32;&#32;parent-&gt;addMessage(<emphasis class="keyword">this</emphasis>);
85 }
86 
<link linkend="d5/de0/classSimpleConnection_1ab580ce17f2b9632414475a49dff64cce">87 </link><emphasis class="keywordtype">void</emphasis>&#32;<link linkend="d5/de0/classSimpleConnection_1ab580ce17f2b9632414475a49dff64cce">SimpleConnection::sendDiff</link>(QList&lt;DiffElement*&gt;*&#32;diffs)&#32;{
88 &#32;&#32;emit&#32;<link linkend="d5/de0/classSimpleConnection_1acd96d2282378dd8262c96604ede3715f">onDiffReceive</link>(diffs);
89 }
90 
<link linkend="db/dbc/classMessageForServer_1a9b98301583759754caf829cc1ed1520d">91 </link>QString&#32;<link linkend="db/dbc/classMessageForServer_1a9b98301583759754caf829cc1ed1520d">MessageForServer::toString</link>()&#32;{
92 &#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;<emphasis class="stringliteral">&quot;MessageForServer&#32;::&#32;connectionType&#32;=&#32;&quot;</emphasis>&#32;+&#32;<link linkend="d2/db5/simpleconnection_8cpp_1aabd3ff178ce3faed55804cc56f78fc6a">stringify</link>(connectionType)&#32;+
93 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="stringliteral">&quot;;&#32;messageType&#32;=&#32;&quot;</emphasis>&#32;+&#32;<link linkend="d2/db5/simpleconnection_8cpp_1aabd3ff178ce3faed55804cc56f78fc6a">stringify</link>(messageType);
94 }
95 
<link linkend="d1/d70/simpleconnection_8h_1aabd3ff178ce3faed55804cc56f78fc6a">96 </link>QString&#32;<link linkend="d2/db5/simpleconnection_8cpp_1aabd3ff178ce3faed55804cc56f78fc6a">stringify</link>(<link linkend="d1/d70/simpleconnection_8h_1ab66d8802c50493de7d50e181d6f8e296">eConnectionType</link>&#32;e)&#32;{
97 &#32;&#32;<emphasis class="keywordflow">switch</emphasis>&#32;(e)&#32;{
98 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">case</emphasis>&#32;<link linkend="d1/d70/simpleconnection_8h_1ab66d8802c50493de7d50e181d6f8e296ab02a4c796f7681c9c90e0c0865392828">eGamer</link>:
99 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;<emphasis class="stringliteral">&quot;eGamer&quot;</emphasis>;
100 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">case</emphasis>&#32;<link linkend="d1/d70/simpleconnection_8h_1ab66d8802c50493de7d50e181d6f8e296af8a067d45287f02c8cd709a3495eb581">eWatcher</link>:
101 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;<emphasis class="stringliteral">&quot;eWatcher&quot;</emphasis>;
102 &#32;&#32;}
103 &#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
104 }
105 
<link linkend="d1/d70/simpleconnection_8h_1abb3e44449c2fd1fa9275c1d4273c66f9">106 </link>QString&#32;<link linkend="d2/db5/simpleconnection_8cpp_1aabd3ff178ce3faed55804cc56f78fc6a">stringify</link>(<link linkend="d1/d70/simpleconnection_8h_1a700ed30d49bfe436323e17539d3a0010">eMessageType</link>&#32;e)&#32;{
107 &#32;&#32;<emphasis class="keywordflow">switch</emphasis>&#32;(e)&#32;{
108 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">case</emphasis>&#32;<link linkend="d1/d70/simpleconnection_8h_1a700ed30d49bfe436323e17539d3a0010aeab6dec369184e6c7d133812064686f9">eFirstMessae</link>:
109 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;<emphasis class="stringliteral">&quot;eFirstMessae&quot;</emphasis>;
110 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">case</emphasis>&#32;<link linkend="d1/d70/simpleconnection_8h_1a700ed30d49bfe436323e17539d3a0010a0bc33fe8075a87a68af6a432b13d7b66">eGetUpdateMessage</link>:
111 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;<emphasis class="stringliteral">&quot;eGetUpdateMessage&quot;</emphasis>;
112 &#32;&#32;}
113 &#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;<emphasis class="stringliteral">&quot;&quot;</emphasis>;
114 }
115 
<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a188daa54b2ed047298df6b889dad5004">116 </link><link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a188daa54b2ed047298df6b889dad5004">SimpleConnection::Receiver::Receiver</link>(QTcpSocket*&#32;<link linkend="d5/de0/classSimpleConnection_1aee87a3e761deb38bce08ebb30cd73362">socket</link>,
117 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="d5/de0/classSimpleConnection">SimpleConnection</link>*&#32;parentThread,
118 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;QObject*&#32;parent)
119 &#32;&#32;&#32;&#32;:&#32;QThread(parent)&#32;{
120 &#32;&#32;this-&gt;socket&#32;=&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a2a61dfb0c5aaff07952e9cc933329fe4">socket</link>;
121 &#32;&#32;this-&gt;parentThread&#32;=&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a86812570e3dd426878732f5ea4ae3b9e">parentThread</link>;
122 &#32;&#32;this-&gt;start();
123 }
124 
<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1ad751c9c2c8152a039876b65197a6b512">125 </link><link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1ad751c9c2c8152a039876b65197a6b512">SimpleConnection::Receiver::~Receiver</link>()&#32;{
126 &#32;&#32;<emphasis class="keyword">delete</emphasis>&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1aa4c39c627b02662a6f68885aa8fca85b">in</link>;
127 }
128 
<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a7cd5d65acac04d9eaa59817f15ddae62">129 </link><emphasis class="keywordtype">bool</emphasis>&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a7cd5d65acac04d9eaa59817f15ddae62">SimpleConnection::Receiver::istThreadStart</link>()&#32;{
130 &#32;&#32;<emphasis class="keywordflow">return</emphasis>&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1ac47df189e93600b9bda2e1dca4e092c9">isStart</link>;
131 &#32;&#32;msleep(100);
132 }
133 
<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1ab77d06e9677b12631ece8695a319e062">134 </link><emphasis class="keywordtype">void</emphasis>&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1ab77d06e9677b12631ece8695a319e062">SimpleConnection::Receiver::stop</link>()&#32;{
135 &#32;&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1acc9d38bc97267217323908d6aaae5972">isWork</link>&#32;=&#32;<emphasis class="keyword">false</emphasis>;
136 &#32;&#32;<emphasis class="keywordflow">while</emphasis>&#32;(<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a7ed726c394f5e48761a19ccecc988173">isLoopActive</link>)&#32;{
137 &#32;&#32;&#32;&#32;msleep(100);
138 &#32;&#32;}
139 }
140 
<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a8bcc914a839e71786071f655ce5afe7e">141 </link><emphasis class="keywordtype">void</emphasis>&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a8bcc914a839e71786071f655ce5afe7e">SimpleConnection::Receiver::run</link>()&#32;{
142 &#32;&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1aa4c39c627b02662a6f68885aa8fca85b">in</link>&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;QDataStream();
143 &#32;&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1aa4c39c627b02662a6f68885aa8fca85b">in</link>-&gt;setDevice(<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a2a61dfb0c5aaff07952e9cc933329fe4">socket</link>);
144 &#32;&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1aa4c39c627b02662a6f68885aa8fca85b">in</link>-&gt;setVersion(QDataStream::Qt_5_7);
145 
146 &#32;&#32;qInfo()&#32;&lt;&lt;&#32;<emphasis class="stringliteral">&quot;starting&#32;message&#32;receiver&#32;loop&quot;</emphasis>;
147 &#32;&#32;<emphasis class="keywordflow">while</emphasis>&#32;(<emphasis class="keyword">true</emphasis>)&#32;{
148 &#32;&#32;&#32;&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a7ed726c394f5e48761a19ccecc988173">isLoopActive</link>&#32;=&#32;<emphasis class="keyword">true</emphasis>;
149 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">if</emphasis>&#32;(!<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1acc9d38bc97267217323908d6aaae5972">isWork</link>)
150 &#32;&#32;&#32;&#32;&#32;&#32;<emphasis class="keywordflow">break</emphasis>;
151 &#32;&#32;&#32;&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1ac47df189e93600b9bda2e1dca4e092c9">isStart</link>&#32;=&#32;<emphasis class="keyword">true</emphasis>;
152 &#32;&#32;&#32;&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a2a61dfb0c5aaff07952e9cc933329fe4">socket</link>-&gt;waitForReadyRead(-1);
153 &#32;&#32;&#32;&#32;qInfo()&#32;&lt;&lt;&#32;<emphasis class="stringliteral">&quot;starting&#32;reading&#32;some&#32;response&quot;</emphasis>;
154 &#32;&#32;&#32;&#32;<link linkend="db/dbc/classMessageForServer">MessageForServer</link>&#32;sendedMessage;
155 &#32;&#32;&#32;&#32;(*in)&#32;&gt;&gt;&#32;sendedMessage;
156 &#32;&#32;&#32;&#32;<emphasis class="keywordtype">int</emphasis>&#32;diffsLenth;
157 &#32;&#32;&#32;&#32;(*in)&#32;&gt;&gt;&#32;diffsLenth;
158 &#32;&#32;&#32;&#32;QList&lt;DiffElement*&gt;*&#32;result&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;QList&lt;DiffElement*&gt;();
159 &#32;&#32;&#32;&#32;<emphasis class="keywordflow">for</emphasis>&#32;(<emphasis class="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;diffsLenth;&#32;i++)&#32;{
160 &#32;&#32;&#32;&#32;&#32;&#32;<link linkend="d7/d78/classDiffElement">DiffElement</link>*&#32;newItem&#32;=&#32;<emphasis class="keyword">new</emphasis>&#32;<link linkend="d7/d78/classDiffElement">DiffElement</link>();
161 &#32;&#32;&#32;&#32;&#32;&#32;(*in)&#32;&gt;&gt;&#32;(*newItem);
162 &#32;&#32;&#32;&#32;&#32;&#32;result-&gt;append(newItem);
163 &#32;&#32;&#32;&#32;}
164 &#32;&#32;&#32;&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a86812570e3dd426878732f5ea4ae3b9e">parentThread</link>-&gt;<link linkend="d5/de0/classSimpleConnection_1ab580ce17f2b9632414475a49dff64cce">sendDiff</link>(result);
165 &#32;&#32;&#32;&#32;qInfo()&#32;&lt;&lt;&#32;<emphasis class="stringliteral">&quot;something&#32;read&#32;from&#32;server&quot;</emphasis>;
166 &#32;&#32;}
167 &#32;&#32;<link linkend="d5/dd5/classSimpleConnection_1_1Receiver_1a7ed726c394f5e48761a19ccecc988173">isLoopActive</link>&#32;=&#32;<emphasis class="keyword">false</emphasis>;
168 }
    </computeroutput></literallayout>
</section>
